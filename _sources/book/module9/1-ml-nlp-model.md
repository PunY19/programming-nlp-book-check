# แบบจำลองการประมวลผลภาษาธรรมชาติ

การประมวลผลภาษาธรรมชาติ คือ เทคนิควิธีที่ใช้ในการประมวลผลและทำความเข้าใจข้อมูลตัวอักษร โดยอาศัยแบบจำลองทางภาษา แบบจำลองหรือโมเดลที่เราพูดถึงนี้หมายถึง การเขียนโปรแกรมที่จำลองการทำความเข้าใจภาษาในด้านต่าง ๆ ซึ่งการจำลองอาจจะไม่ได้สอดคล้องกับวิธีที่มนุษย์ทำความเข้าใจภาษา แต่ว่าแบบจำลองจำลองพฤติกรรมการประมวลผลภาษาได้ดีพอ ที่จะนำไปใช้ในการทำงานที่เกี่ยวข้องกับภาษาธรรมชาติได้ 
งานที่สามารถใช้โมเดลการประมวลผลภาษาธรรมชาติได้อย่างมีประสิทธิภาพ และพบเห็นได้บ่อย ๆ ได้แก่  เช่น การแท็กชนิดของคำ (part-of-speech tagging) การตรวจจับเอนติตี้ (named entity recognition) การวิเคราะห์อารมณ์ความรู้สึก (sentiment analysis) แบบจำลองหัวข้อ (topic model) การแปลด้วยเครื่อง (machine translation) ซึ่งทั้งหมดนี้คือต่างใช้การเรียนรู้ของเครื่อง (machine learning) ในการสร้างแบบจำลองสำหรับงานเหล่านี้ขึ้นมา กล่าวคือเราเขียนโปรแกรมที่เรียนรู้การทำงานเหล่านี้โดยการหาแพทเทิร์นจากชุดข้อมูลที่เหมาะสม เราไม่ได้ตั้งโปรแกรมให้ทำงานตามกฎของภาษาศาสตร์โดยตรง 

ในปัจจุบันเราสามารถดาวน์โหลดโมเดลและนำมาประยุกต์ใช้ได้ทันทีโดยที่ต้องไม่ทำการสร้างโมเดลใหม่ตั้งแต่ต้น แต่ว่าอาจจะมีโมเดลสำหรับบางงานและบางภาษาเท่านั้น และโมเดลของแต่ละภาษามีประสิทธิภาพ และความแม่นยำแตกต่างกันไป ในบทนี้เราจะเรียนรู้วิธีการใช้ไลบรารีเพื่อดาวน์โหลดและประยุกต์ใช้โมเดลในการวิเคราะห์ข้อมูลภาษาโดยอัตโนมัติ

## การแท็กชนิดของคำ (Part-of-speech tagging) 

ชนิดของคำ (part-of-speech tag) ในเชิงภาษาศาสตร์ถูกสร้างขึ้นมาเป็นส่วนหนึ่งของกฎไวยากรณ์ของภาษาที่กำหนดว่าคำชนิดใดสามารถมีความสัมพันธ์กับคำชนิดใด ในลักษณะไหนได้บ้าง  นอกจากนั้นแล้วยังมีบทบาทสำคัญในการทำความเข้าใจความหมายและโครงสร้างของประโยค
เนื่องจากช่วยให้เรารู้ว่าแต่ละคำในประโยคทำหน้าที่อะไร  เช่น คำนาม (noun) มักจะทำหน้าที่เป็นประธานของประโยค หรือเป็นส่วนเติมเต็มของกริยา หรีอ คุณศัพท์ (adjective) มักจะทำหน้าที่เป็นตัวขยายความหมายของคำนาม เป็นต้น 

ในการประมวลผลภาษาธรรมชาติ ชนิดของคำมักจะช่วยในการสกัดข้อมูล (information extraction) จากข้อมูลที่เป็นข้อความ เช่น ถ้าหากเราต้องการสกัดเอาชื่อของบุคคลจากข้อความ เราอาจจะเลือกเอาเฉพาะคำที่เป็นคำนามมาพิจารณาเท่านั้น หรือถ้าหากเราต้องการสกัดคีย์เวิร์ดที่บ่งบอกถึงความหมายใจความสำคัญของคลังเอกสาร เราอาจจะเลือกเฉพาะไบแกรมที่มีคำนามและคำกริยามาพิจารณาเท่านั้น 

### การแยกชนิดของคำ

ชนิดของคำมีชนิด ชนิดอะไรบ้าง ทฤษฎีการแยกชนิดของคำมีอยู่หลากหลายทฤษฎี เช่น เด็กนักเรียนไทยมักจะคุ้นเคยกับการแยกชนิดของคำตามพระยาอุปกิตศิลปสารซึ่งแยกชนิดของคำเป็น 7 ชนิด ได้แก่ คำนาม คำสรรพนาม คำวิเศษณ์ คำกริยา คำบุพบท คำสันธาน และคำอุทาน  ในการประมวลผลภาษาธรรมชาติ เรามักใช้ทฤษฎีของ ชุดป้ายระบุชนิดของคำสากล (Universal Part-of-speech Tagset) ทฤษฎีนี้กำหนดชนิดของคำออกเป็น 17 ชนิด ซึ่งสามารถจัดออกเป็น 3 กลุ่มใหญ่ ได้แก่ 

1. คำชนิดเปิด (open class word) คือกลุ่มคำที่สามารถเพิ่มคำใหม่เข้าไปได้เรื่อยๆ คำชนิดเปิดมักมีความหมายที่ชัดเจนและสามารถยืนอยู่ได้ด้วยตัวเอง เช่น การกระทำ คน สัตว์ สิ่งของ สถานที่ คำชนิดเปิดประกอบด้วยคำ 6 ชนิดย่อย
    - คำวิเศษณ์ (adverb)
    - คำคุณศัพท์ (adjective)
    - คำอุทาน (interjection)
    - คำนาม (noun)
    - คำกริยา (verb)
    - วิสามานยนาม หรือคำนามชื่อเฉพาะ (proper noun)
2. คำชนิดปิด (closed class word) เป็นกลุ่มคำที่มีจำนวนจำกัดและไม่ค่อยมีการเพิ่มคำใหม่ หน้าที่หลักของคำชนิดปิดคือการเชื่อมโยงหรือจัดระเบียบความสัมพันธ์ระหว่างคำในประโยค คำชนิดปิดมักมีความหมายที่น้อยลงหรือเป็นนามธรรม และมักไม่สามารถยืนอยู่ได้ด้วยตัวเอง แต่ต้องใช้งานร่วมกับคำอื่นเพื่อสร้างประโยคที่ถูกหลักไวยากรณ์ คำชนิดปิดประกอบด้วยคำ 8 ชนิดย่อย  
    - คำบุพบท (adposition)
    - คำช่วยกริยา (auxiliary)
    - ตัวกำหนด (determiner)
    - ตัวเลข (numeral)
    - คำอนุภาค (particle)
    - คำสรรพนาม (pronoun)
    - คำสันธานเชื่อมความ (coordinating conjunction)
    - คำสันธานซ้อนความ (subordinating conjunction)
3. คำชนิดอื่น ๆ ประกอบด้วยคำ 3 ชนิดย่อย 
    - เครื่องหมายวรรคตอน (punctuation)
    - สัญลักษณ์ (symbol)
    - อื่น ๆ ที่ไม่เข้าพวกกับคำชนิดที่กล่าวมาแล้ว

 {cite}` petrov-etal-2012-universal`     

ชุดป้ายระบุชนิดของคำสากลเป็นระบบการจำแนกชนิดของคำที่มีมาตรฐานเดียวกันทุกภาษา เพื่อให้การทำงานของโมเดลภาษาต่าง ๆ สามารถทำงานร่วมกันได้โดยสะดวกต่อการใช้โมเดลที่มีการใช้การถ่ายโอนข้ามภาษา (cross-lingual transfer) การใช้ชุดป้ายระบุชนิดของคำสากล จึงเป็นเครื่องมือที่สำคัญและได้รับความนิยมในการพัฒนาระบบประมวลผลภาษาธรรมชาติที่มีประสิทธิภาพ

## การตรวจจับเอนทิตี (Named Entity Recognition)
เอนทิตีในเชิงทฤษฎีแล้วคือ สิ่งที่มีตัวตนจริงและอิสระไม่เกี่ยวพันกับสิ่งอื่น ๆ ซึ่งเรามักจะหมายถึงบุคคล องค์กร บริษัท หรือสถานที่ เพราะฉะนั้นคำว่า named entity หมายความถึง บุคคล องค์กร สถานที่ หรือสิ่งที่มีตัวตนประเภทอื่น ๆ ที่มีสามารถอ้างถึงได้ด้วยชื่อ  ในบริบทของการประมวลผลภาษาธรรมชาติการตรวจจับเอนทิตี (Named Entity Recognition หรือ NER) คือ การตรวจจับชื่อของบุคคล ชื่อขององค์กร ชื่อของสถานที่ ชื่อของเหตุการณ์ หรือชื่อของสิ่งของที่มีความสำคัญออกมาจากข้อความ และในทางปฏิบัติแล้วการตรวจจับเอนทิตีไม่ได้จำกัดเพียงแต่เอนทิตีอย่างเดียว แต่หมายความรวมถึงการตรวจจับส่วนอื่นของข้อความที่มีความสำคัญ​และอาจจะไม่ได้มีตัวตนอิสระตามความหมายของเอนทิตี เช่น

- เวลาและวันที่ เช่น "เมื่อวาน" หรือ "สัปดาห์หน้า"
- จำนวนเงิน เช่น "500 บาท" หรือ "หนึ่งพันเหรียญสหรัฐ"
- จำนวนและขนาด เช่น "3 กิโลเมตร" หรือ "5 ลิตร"
- คำนำหน้าชื่อ และคำศัพท์ทั่วไปที่เป็นคำบ่งบอกสถานที่ เช่น "เด็กชาย" "นางสาว" หรือ "โรงเรียน" ซึ่งไม่ได้บ่งบอกถึงชื่อเฉพาะของบุคคลหรือสถานที่


การตรวจจับเอนทิตีมีประโยชน์อย่างมากในหลายด้านของการประมวลผลภาษาธรรมชาติ (NLP) และการประยุกต์ใช้ในงานต่างๆ โดยสามารถยกตัวอย่างได้ดังนี้ 

- ในการวิเคราะห์ความเห็นของลูกค้าเกี่ยวกับผลิตภัณฑ์ในโซเชียลมีเดีย บริษัทสามารถใช้การตรวจจับเอนทิตีเพื่อระบุชื่อผลิตภัณฑ์ ชื่อบริษัท หรือบุคคลที่เกี่ยวข้อง จากนั้นสามารถวิเคราะห์ความเห็นในเชิงบวกหรือลบที่มีต่อเอนทิตีเหล่านี้ได้อย่างมีประสิทธิภาพ ซึ่งช่วยให้บริษัทสามารถเข้าใจความคิดเห็นของลูกค้าเกี่ยวกับผลิตภัณฑ์หรือบริการได้อย่างละเอียด และสามารถปรับปรุงผลิตภัณฑ์และการบริการตามความคิดเห็นที่ได้รับได้อย่างตรงจุด 
- ในระบบตอบคำถามอัตโนมัติ เช่น ระบบบริการหลังการขายออนไลน์  การตรวจจับเอนทิตีสามารถระบุข้อมูลสำคัญจากคำถามของผู้ใช้ เช่น ชื่อผลิตภัณฑ์ หรือปัญหาที่เกิดขึ้น ทำให้ระบบสามารถให้คำตอบที่แม่นยำและรวดเร็วแก่ผู้ใช้ ลดเวลาที่ต้องใช้ในการค้นหาข้อมูลและเพิ่มประสิทธิภาพในการให้บริการลูกค้า
- ในด้านการสกัดข้อมูลทางการแพทย์ การตรวจจับเอนทิตีมีบทบาทสำคัญในการวิเคราะห์เวชระเบียนหรือเอกสารทางการแพทย์ โดยสามารถระบุชื่อโรค ชื่อยา ชื่อแพทย์ หรือวันนัดหมายได้อย่างชัดเจน ซึ่งช่วยในการจัดการข้อมูลทางการแพทย์อย่างเป็นระบบ สามารถสกัดข้อมูลสำคัญเพื่อใช้ในการวินิจฉัยโรค หรือการวิจัยทางการแพทย์ได้อย่างรวดเร็วและแม่นยำ 
- ในการวิเคราะห์ข่าวสารจากแหล่งต่างๆ การตรวจจับเอนทิตีสามารถระบุชื่อบุคคลสำคัญ เหตุการณ์สำคัญ สถานที่ หรือชื่อองค์กรที่ปรากฏในข่าว ทำให้สำนักข่าวหรือองค์กรที่เกี่ยวข้องสามารถติดตามและวิเคราะห์ข้อมูลข่าวสารได้อย่างมีประสิทธิภาพ สามารถสรุปแนวโน้มข่าวสาร หรือทำการวิจัยเชิงลึกเกี่ยวกับประเด็นที่สำคัญได้ 


การตรวจจับเอนทิตีมักจะใช้เทคนิคการประมวลผลภาษาธรรมชาติเช่นเดียวกับการแยกชนิดของคำ โดยใช้โมเดลการเรียนรู้ของเครื่องที่เรียนรู้จากชุดข้อมูลที่มีเอนทิตีที่ถูกติดป้ายไว้ และใช้เอนทิตีที่ติดป้ายเหล่านั้นในการสร้างโมเดลที่สามารถตรวจจับเอนทิตีใหม่ได้

## ไลบรารี spacy สำหรับการติดป้ายชนิดของคำ และการตรวจจับเอนทิตี
การติดป้ายชนิดของคำ และการตรวจจับเอนทิตีอัตโนมัติจำเป็นต้องใช้โมเดลแบบการเรียนรู้ของเครื่องในการแยก เพราะฉะนั้นไลบรารีที่ใช้จะต้องมีโมเดลเหล่านี้เตรียมไว้ให้พร้อมใช้ ไลบรารี spacy เป็นไลบรารีที่รองรับการประมวลผลภาษาธรรมชาติหลากหลายภาษา รวมถึงมีแบบจำลองการประมวลผลภาษาธรรมชาติหลากหลายขนาดให้เลือกใช้ตามความเหมาะสม และตามข้อจำกัดในการนำแบบจำลองไปใช้จริง  {cite}`spacy` ปัจจุบัน (2024) spacy รองรับการติดป้ายชนิดของคำสำหรับภาษาหลายภาษา เช่น ภาษาอังกฤษ ภาษาสเปน ภาษาฝรั่งเศส ภาษาจีน ภาษาญี่ปุ่น ภาษาเกาหลี 

ขั้นแรกต้องหาชื่อชุดโมเดลที่เราต้องการใช้ รายชื่อชุดโมเดลอยู่บนเว็บไซต์ของ spacy ซึ่งมีเอกสารประกอบการใช้งานที่เป็นปัจจุบันอยู่ โมเดลเหล่านี้ประกอบไปด้วยโมเดลย่อยหลาย ๆ โมเดลด้วยกัน เราสามารถตรวจสอบดูบนเว็บไซต์ได้ว่าโมเดลแต่ละชุดประกอบด้วยโมเดลอะไรบ้าง  ตัวอย่างเช่น สำหรับภาษาจีน มีชุดโมเดลที่มีโมเดลการแยกชนิดของคำได้อยู่สามแบบจำลองได้แก่ `zh_core_web_sm` (ขนาดเล็ก) `zh_core_web_md` (ขนาดกลาง) และ  `zh_core_web_lg` (ขนาดใหญ่) ทั้งสามชุดในเวอร์ชันปี 2024 ประกอบไปด้วย 5 โมเดลย่อย ได้แก่ โมเดลการตัดคำ โมเดลการตัดประโยค โมเดลการวิเคราะห์โครงสร้างประโยค โมเดลการติดป้ายชนิดของคำ โมเดลการตรวจจับเอนทิตี  

หากเรายังไม่ได้ติดตั้งไลบรารี spacy เราสามารถติดตั้งโดยใช้คำสั่ง `pip install spacy` หลังจากนั้นเราสามารถดาวน์โหลดและติดตั้งแบบจำลองที่ต้องการได้โดยใช้คำสั่ง `python -m spacy download` ตามด้วยชื่อแบบจำลองที่ต้องการดาวน์โหลดและติดตั้ง เช่น

```bash
python -m spacy download zh_core_web_md
```

วิธีการใช้ spacy จะต่างจากการใช้ pythainlp ตรงที่ว่าเราจะต้องสร้างอ็อบเจกต์ที่ทำหน้าที่เป็นตัวประมวลผลที่โหลดโมเดลที่ต้องการมาให้พร้อม เพื่อที่จะได้ไม่ต้องโหลดโมเดลซ้ำ ๆ บ่อย ๆ เพราะถ้าหากเป็นโมเดลขนาดใหญ่แล้วต้องโหลดโมเดลซ้ำ ๆ จะทำให้โปรแกรมทำงานช้า ไม่เหมาะกับการประมวลผลข้อมูลขนาดใหญ่ที่เราอาจจะต้องลูปวนเพื่อประมวลผลข้อมูลทีละชิ้น ตัวอย่างการใช้งาน spacy ในการแยกชนิดของคำแสดงในโค้ดต่อไปนี้

```python 
import spacy
model_name = 'zh_core_web_md'
nlp_processor = spacy.load(model_name)
text  = '张伟和李娜在漂亮的上海吃饭'
doc = nlp_processor(text)
for token in doc:
    print(token.text, token.pos_)
```

ผลลัพธ์ที่ได้จะแสดงชนิดของคำที่แยกออกมาจากข้อความ ตามที่กำหนดไว้ในชุดป้ายระบุชนิดของคำสากลดังนี้

```
张伟 PROPN
和 CCONJ
李娜 PROPN
在 ADP
漂亮 VERB
的 PART
上海 PROPN
吃饭 VERB
```

 ในตัวอย่างนี้เราโหลดแบบจำลอง `zh_core_web_md` ซึ่งเป็นแบบจำลองขนาดกลางสำหรับภาษาจีน โดยการเรียกคำสั่ง `spacy.load` เพื่อสร้างตัวประมวลผลข้อความและเก็บไว้ในตัวแปรชื่อ `nlp_processor` ซึ่งสามารถใช้ได้คล้ายกับว่าเป็นฟังก์ชัน เราจึงสามารถเรียก `nlp_processor(text)` ได้เลยโดยไม่ต้องใช้ชื่อเมท็อดอื่น ผลที่ได้คือเป็น `Doc` อ็อบเจกต์ที่เราสามารถวนลูปเพื่อดึง `Token` อ็อบเจกต์ออกมาและดึงชนิดของคำออกมาได้โดยใช้ `token.pos_` ในการเข้าถึงชนิดของคำ


 ข้อสังเกตที่สำคัญอีกประการหนึ่งของการใช้ spacy คือ ไลบรารีนี้ประมวลข้อความเป็นแบบการทำงานแบบสายท่อ (pipeline) กล่าวคือสตริงที่รับเข้ามาจะถูกประมวลหลาย ๆ ขั้นในครั้งเดียว เช่น การประมวลภาษาจีนจะเริ่มด้วยการตัดคำ ต่อด้วยการแยกชนิดของคำ การวิเคราะห์โครงสร้างประโยค และจบด้วยการตรวจจับเอนทิตี จากนั้นผู้ใช้สามารถเข้าถึงผลการวิเคราะห์ทั้งหมดนี้ผ่าน `Doc` อ็อบเจกต์ที่ได้รับกลับมาจากการเรียก `nlp_processor(text)` โดยไม่ต้องเรียกแต่ละขั้นตอนเอง  เพราะฉะนั้นเราสามารถเข้าถึงรายชื่อเอนทิตีได้เลย โดยไม่ต้องประมวลผลข้อความอีกครั้ง
 ```python
for ent in doc.ents:
    print(ent.text, ent.label_)
```
ผลลัพท์ที่ได้จะแสดงชื่อเอนทิตีที่ตรวจจับออกมาจากข้อความดังนี้
```
张伟 PERSON
李娜 PERSON
上海 GPE
```
จากข้อความตัวอย่างที่ป้อนเข้าไป ตัวประมวลผลตรวจจับชื่อเอนทิตีที่เป็นบุคคลทั้งหมดสองชื่อ ได้แก่  张伟 และ 李娜 และเอนทิตีแบบภูมิรัฐศาสตร์ (GPE ซึ่งย่อมาจาก geopolitical entity) หนึ่งชื่อ ได้แก่ 上海 

## การวิเคราะห์อารมณ์ความรู้สึก (sentiment analysis)

การวิเคราะห์อารมณ์ความรู้สึก (sentiment analysis) คือกระบวนการในการตรวจจับและจำแนกอารมณ์หรือความรู้สึกที่แสดงออกมาในข้อความ โดยใช้เทคนิคทางด้านประมวลผลภาษาธรรมชาติ และการเรียนรู้ของเครื่อง การวิเคราะห์อารมณ์ความรู้สึกมักถูกใช้เพื่อประเมินความคิดเห็นของผู้ใช้หรือประชาชนต่อผลิตภัณฑ์ บริการ หรือเหตุการณ์ต่างๆ โดยสามารถจำแนกออกเป็นอารมณ์เชิงบวก เชิงลบ หรือเป็นกลาง นับว่าเป็นการประยุกต์การใช้ประมวลผลภาษาธรรมชาติในโลกของวิทยาการข้อมูลที่เห็นเด่นชัด และเป็นที่นิยมที่สุดอย่างหนึ่งในปัจจุบัน ตัวอย่างของการวิเคราะห์อารมณ์ความรู้สึกมีอยู่หลากหลายแบบ เช่น

- การวิเคราะห์ความคิดเห็นของลูกค้าในโซเชียลมีเดีย: สมมติว่าเรามีข้อความจากทวิตเตอร์เกี่ยวกับผลิตภัณฑ์ใหม่ของบริษัท เราสามารถแยกแยะความคิดเห็นเชิงบวก ลบ หรือกลาง และนับจำนวนความคิดเห็นแต่ละประเภทได้ และแยกวิเคราะห์ได้ บริษัทสามารถใช้ข้อมูลนี้เพื่อเข้าใจความคิดเห็นของลูกค้าต่อผลิตภัณฑ์ใหม่ และนำไปปรับปรุงผลิตภัณฑ์หรือกลยุทธ์การตลาดได้

- การประเมินความพึงพอใจของลูกค้าในบทวิจารณ์ออนไลน์:
การวิเคราะห์อารมณ์ความรู้สึกสามารถแยกแยะได้ว่าอาจจะมีความรู้สึกเชิงบวกต่อผลิตภัณฑ์ แต่มีความรู้สึกเชิงลบต่อการบริการ ร้านอาหารสามารถใช้ข้อมูลนี้เพื่อปรับปรุงการบริการและรักษาคุณภาพอาหารให้ดีอยู่เสมอ

- การติดตามความคิดเห็นเรื่องการเมืองบนสื่อออนไลน์: การศึกษาเรื่องวิเคราะห์อารมณ์ความรู้สึกที่อยู่บนสื่อออนไลน์ เช่น เว็บไซต์ reddit สามารถช่วยให้นักวิเคราะห์เข้าใจความคิดเห็นของประชาชนต่อเรื่องการเมือง เนื่องจากเหตุการณ์ทางการเมืองต่าง ๆ ส่งผลต่ออารมณ์ความรู้สึกที่ปรากฏอยู่ในสื่อเหล่านี้ {cite}`tachaiya2021raffman` การวิเคราะห์อารมณ์ความรู้สึกบนฟอรัมออนไลน์มีประโยชน์อย่างมากในการทำความเข้าใจและตอบสนองต่อความคิดเห็นของประชาชนได้อย่างมีประสิทธิภาพ โดยช่วยให้เราสามารถติดตามการเปลี่ยนแปลงของอารมณ์ความรู้สึกในช่วงเวลาต่างๆ เมื่อเกิดเหตุการณ์สำคัญ เช่น การถอดถอนประธานาธิบดี ซึ่งจะเป็นประโยชน์ในการระบุแนวโน้มทางการเมืองและสังคม นอกจากนี้ ยังสามารถช่วยในการวิเคราะห์แนวโน้มการแบ่งขั้วทางการเมืองหรือความรู้สึกที่มีต่อประเด็นสำคัญในสังคมอีกด้วย 





*under construction*

## แบบจำลองหัวข้อ (topic model)

*under construction*

## การแปลด้วยเครื่อง (machine translation)

*under construction*


## แบบจำลองภาษาขนาดใหญ่ (LLM: Large Language Model)
*under construction*