# โมเดลภาษาขนาดใหญ่

ก่อนนี้มนุษย์ได้เพียงแค่ฝันว่าจะมีโปรแกรมที่สามารถพูดคุยโต้ตอบ คุยเล่นแก้เหงากับเรา แปลภาษา ย่อความ หรือทำงานต่าง ๆ ที่จำเป็นต้องใช้มนุษย์ต้องนั่งทำเองอย่าง ร่างสัญญาซื้อขาย วางแผนกลยุทธ์ทางการตลาด ให้ขอแนะนำเกี่ยวกับสัมภาษณ์งาน เขียนโปรแกรมในการประมวลผลข้อมูล และงานอื่น ๆ ที่ต้องใช้เวลาในการเรียนรู้นานนับปีจึงเกิดความเชี่ยวชาญ โปรแกรมแบบนี้เคยเป็นเพียงสิ่งที่เกิดในนิยายวิทยาศาสตร์เท่านั้น หลาย ๆ คนไม่เคยนึกฝันได้ว่าโปรแกรมที่มีความฉลาดทัดเทียมกับมนุษย์ในหลากหลายด้านนั้นจะกลายมาเป็นความจริงได้ในยุคปี 2020 โมเดลนี้เราเรียกว่าโมเดลภาษาขนาดใหญ่ (Large Language Model หรือ LLM) 

นักวิทยาการคอมพิวเตอร์ร่วมกันพัฒนาปัญญาประดิษฐ์ที่สามารถทำงานต่าง ๆ ได้ใกล้เคียงกับความสามารถและสติปัญญาของมนุษย์ ความสามารถทางภาษาเป็นความสามารถสร้างแบบจำลองขึ้นมาได้ยาก เนื่องจากภาษามีหลากหลายภาษา มีวิธีการหลากหลายที่ในสื่อการความหมาย ไม่ว่าจะเป็นการใช้คำ สำนวน หรือความหมายโดยนัยที่ต้องอาศัยบริบทในระดับบทสนทนาไปถึงระดับสังคมโดยรวมจึงจะทำความเข้าใจได้ นอกจากนั้นแล้วภาษายังเป็นสื่อที่ในการรวบรวมและสื่อสารความคิดและความรู้ เพราะฉะนั้นโมเดลที่จะจำลองความสามารถทางภาษาของมนุษย์จำเป็นต้องมีความรู้เกี่ยวกับภาษาเพื่อใช้สื่อสาร ยังจะต้องมีความรู้เกี่ยวกับโลกที่จะประกอบสร้างเป็นบริบทที่เอื้อต่อการทำความเข้าใจความหมายในภาษา โมเดลปัญญาประดิษฐ์จำพวกนี้เราจัดว่าเป็นโมเดลปัญญาประดิษฐ์แบบกว้าง  (artificial general intelligence) ซึ่งหมายถึงปัญญาประดิษฐ์ที่มาจากโมเดลเดียวแต่สามารถทำงานได้หลากหลายงาน และสามารถปรับตัวเข้ากับงานใหม่ได้ด้วยตนเอง คล้ายคลึงกับสมองของมนุษย์ที่เป็นศูนย์รวมของปัญญามนุษย์และสามารถสั่งการในการทำงานได้หลากหลายรูปแบบ 

```{margin} คำศัพท์
โมเดลปัญญาประดิษฐ์แบบกว้าง  (artificial general intelligence)
```

## โมเดลภาษาขนาดใหญ่คืออะไร

โมเดลภาษาขนาดใหญ่ เป็นโมเดลขนาดใหญ่ที่ถูกสร้างขึ้นเพื่อทำความเข้าใจภาษา ตอบโต้ และสร้างข้อความเป็นภาษามนุษย์ได้อย่างคล่องแคล่ว และสะท้อนถึงความเข้าใจภาษา โมเดลเหล่านี้ถูกพัฒนาให้มีขนาดใหญ่ขึ้นเรื่อย ๆ โดยใช้ข้อมูลจำนวนมหาศาลและการเรียนรู้เชิงลึก (deep learning) เพื่อให้สามารถตอบสนองต่อคำถามที่อาจจะต้องอาศัยความรู้เฉพาะ หรือสร้างข้อความที่อาจจะรายละเอียดทางภาษาที่ละเอียดอ่อน ซับซ้อน และทำนองทางภาษาลื่นไหลใกล้เคียงกับภาษามนุษย์มากขึ้น ตัวอย่างของแอพพลิเคชันที่ทำมาจากโมเดลภาษาขนาดใหญ่ที่มีชื่อเสียงที่สุด 

- ChatGPT ของบริษัท OpenAI 
- Gemini ของบริษัท Google
- Copilot ของบริษัท Microsoft
- Claude ของบริษัท Anthropic

โมเดลภาษาขนาดใหญ่ถูกพัฒนาขึ้นมาเพื่อตอบสนองคำสั่งจากผู้ใช้งาน เรียกว่าพรอมต์ (prompt) ถ้าหากพรอมต์อยู่ในรูปแบบของคำถาม โมเดลภาษาขนาดใหญ่ก็จะสร้างข้อความที่เป็นคำตอบมาให้ เช่น

> **User**: ที่ดินที่ตั้งของสยามสแควร์เป็นของใคร
>
> **ChatGPT (GPT-4o)**: ที่ดินที่ตั้งของสยามสแควร์เป็นของจุฬาลงกรณ์มหาวิทยาลัย ซึ่งเป็นมหาวิทยาลัยแห่งแรกของประเทศไทย โดยที่ดินดังกล่าวอยู่ในความดูแลของสำนักงานจัดการทรัพย์สินจุฬาลงกรณ์มหาวิทยาลัย (PMCU) ที่รับผิดชอบในการบริหารจัดการและพัฒนาพื้นที่สยามสแควร์ให้เป็นศูนย์การค้าและแหล่งบันเทิงที่สำคัญในกรุงเทพมหานคร

นอกจากนั้นเรายังสามารถเขียนพรอมต์ในรูปแบบของคำสั่ง และโมเดลภาษาขนาดใหญ่ก็จะสร้างข้อความที่ตอบสนองต่อคำสั่งนั้น เช่น 

> **User**: แปล "จงมาเที่ยวที่เมืองของฉัน" เป็นภาษาอังกฤษและภาษาจีน
>
> **ChatGPT (GPT-4o)**: Sure! Here is the translation:
>
> In English:
> "Come visit my city."
> 
> In Chinese:
> "来我的城市旅游吧。" (Lái wǒ de chéngshì lǚyóu ba.)

## การฝึกและพัฒนาโมเดลภาษาขนาดใหญ่

โมเดลภาษา ที่นิยมใช้ในปัจจุบันทำงานโดยการใช้ข้อความที่อยู่ที่ทางซ้ายมือ (ข้อความได้รับมา) มาเป็นบริบทเพื่อทำนายคำทีอยู่ถัดไป เพื่อให้เห็นภาพได้ชัดเจนขึ้นให้พิจารณาตัวอย่างต่อไปนี้

> You will be successful in your career if you don't give __ 

โมเดลภาษาที่ดี เมื่อได้รับสตริง *You will be successful in your career if you don't give* จะต้องทำนายว่าคำถัดไปควรจะเป็นคำว่า *up* เพราะคำว่า *up* นั้นเป็นคำที่เป็นไปได้ที่สุดในบริบทนี้ แต่ถ้าโมเดลทำนายว่าคำถัดไปควรจะเป็นคำว่า *in* หรือ *on* ก็จะถือว่าโมเดลนั้นมีความผิดพลาด และควรทำการปรับปรุงให้ดีขึ้น โมเดลภาษาที่ดีจะต้องทำความเข้าใจข้อความที่ได้รับมา เพื่อใช้เป็นบริบทในการทำนายคำถัดไป เพราะฉะนั้นกระบวนการฝึกโมเดลภาษาคือการฝึกให้โมเดลมีความรู้ทางภาษา (linguistic knowledge) โดยตรง 

```{margin} คำศัพท์
โมเดลภาษา  (language model)
```

ผลพลอยได้ที่ได้จากการฝึกโมเดลภาษาให้ทำนายคำถัดไป คือการทำให้โมเดลมีความรู้เกี่ยวกับโลก (world knowledge) ให้พิจาาณตัวอย่างต่อไปนี้

> The 2024 Summer Olympics was held in _.
> The BTS Skytrain will take you from Siam Square to Ari in 10 _. 

คำตอบที่ถูกต้องของตัวอย่างข้างต้น คือ *Paris* และ *minutes* ตามลำดับ โมเดลภาษาที่จะตอบคำถามดังกล่าวได้ถูกต้อง นอกเหนือจากที่จะต้องความรู้ทางภาษา ยังจำเป็นต้องมีความรู้เกี่ยวกับเหตุการณ์ที่เกิดขึ้นในโลก และความรู้เกี่ยวกับเส้นทางของรถไฟฟ้าในกรุงเทพฯ อีกด้วย เพราะฉะนั้นในการฝึกโมเดลภาษาให้ทำนายคำถัดไป เท่ากับอัดฉีดความรู้เกี่ยวกับโลกในกับโมเดลอีกด้วย 

การพัฒนาของโมเดลภาษาโดยการฝึกให้ทำนายคำที่อยู่ถัดจากบริบททางภาษา มีรากฐานมาจากการใช้โมเดลทางสถิติที่อาศัยการนับความถี่ของคำที่ปรากฏร่วมอยู่ใกล้เคียงกัน โมเดลเหล่านี้เรียกว่าโมเดลภาษาเอ็นแกรม (N-gram Language Model) ต่อมาได้พัฒนาเป็นโมเดลการเรียนรู้เชิงลึกที่ซับซ้อนยิ่งขึ้น เช่น โมเดลภาษาเครือข่ายประสาทแบบวนกลับ (Recurrent Neural Network หรือ RNN) พัฒนาจนมาถึงโมเดลประเภททรานส์ฟอร์มเมอร์ (Transformer) ที่นับได้ว่าเปลี่ยนโฉมวงการการประมวลผลภาษาธรรมชาติในปัจจุบัน โมเดลภาษาขนาดใหญ่ที่ใช้โมเดลทรานส์ฟอร์มเมอร์ที่ประสบความสำเร็จที่สุด คือโมเดลจีพีที (Generative Pre-trained Transformer หรือ GPT) ซึ่งได้รับการพิสูจน์ว่ามีความรู้หลากหลายด้าน และสามารถทำความเข้าใจคำถาม และคำสั่งที่ผู้ใช้ป้อนเข้ามาได้อย่างแม่นยำน่าทึ่ง โมเดลจีพีที-2 (GPT-2) มีความสามารถในการทำความเข้าใจบริบท หากเราเขียนพรอมต์ว่า 

> Once upon the time, the astronomists were left on an unknown deserted planet close to Mars. Eric Polski, the captain of the team, stepped out of the ship and 

โมเดลจีพีที-2 จะเติมว่า

> began to explain the situation to the crew. 
> "We're going to have to go to the moon," he said. 

โมเดลมีความเข้าใจว่าทีมนักดาราศาสตร์กำลังตกอยู่ในสถานการณ์ที่ไม่น่าไว้วางใจ ทำให้กัปตันต้องอธิบายสถานการณ์ที่เกิดขึ้น (*began to explain the situation to the crew*) และโมเดลมีความเข้าใจว่า Eric Polski น่าจะเป็นผู้ชายและใช้ *he* ในการอ้างถึง Eric Polski ได้อย่างถูกต้้อง โดยรวมแล้วข้อความที่เขียนขึ้นมีความสมเหตุสมผลและเป็นไปได้ สะท้อนให้เห็นถึงความสามารถในการเข้าใจภาษาของโมเดลจีพีที-2


```{margin} คำศัพท์
ทรานส์ฟอร์มเมอร์ (Transformer) 
```

ขนาดของตัวโมเดลเป็นปัจจัยที่สำคัญมากสำหรับการวิวัฒนาการของโมเดลภาษา และความสำเร็จของโมเดลภาษาที่ใช้ทรานส์ฟอร์มเมอร์ เราวัดขนาดของโมเดลด้วยจำนวนตัวเลขที่โมเดลต้องใช้ในการประมวลผลข้อความตั้งแต่ต้นจนจบ ตัวเลขเหล่านี้เราเรียกว่าพารามิเตอร์ นักวิจัยได้พบว่าเพื่อเพิ่มจำนวนพารามิเตอร์ในโมเดลจีพีทีขึ้นเรื่อย ๆ ยิ่งทำให้การประมวลภาษาธรรมชาติดีขึ้นเรื่อย ๆ โมเดลจีพีที-2 มีจำนวนพารามิเตอร์ถึง 1,000 ล้านพารามิเตอร์ซึ่งใช้พื้นที่หน่วยความจำ 12 - 16 กิกะไบต์เมื่อนำไปใช้จริง และ โมเดลจีพีที-3 (GPT-3) มีจำนวนพารามิเตอร์ถึง 175,000 ล้านพารามิเตอร์ ซึ่งใช้พื้นที่หน่วยความจำ 175 กิกะไบต์ ซึ่งเป็นจำนวนที่ใหญ่มาก ไม่สามารถเก็บไว้ใน RAM หรือหน่วยความจำของเครื่องคอมพิวเตอร์ทั่วไปได้ แต่สามารถเก็บไว้ในหน่วยความจำของหน่วยประมวลผลกราฟิกหรือจีพียู (Graphic Processing Unit หรือ GPU) ซึ่งที่มีความจุใหญ่ขึ้นและมีความเร็วในการประมวลผลที่สูงกว่าหน่วยความจำของเครื่องคอมพิวเตอร์ทั่วไป ในส่วนของจีพีที-3 เราต้องใช้เครื่องที่มีจีพียูหลาย ๆ ตัวจึงจะสามารถใช้งานได้ ในปัจจุบันโมเดลภาษาขนาดใหญ่ได้มีจำนวนพารามิเตอร์เกินล้านล้านตัวไปแล้ว เพราะฉะนั้นการใช้งานโมเดลภาษาขนาดใหญ่เป็นสิ่งที่นักวิเคราะห์ข้อมูลมักจะใช้บริการจากผู้ให้บริการด้านปัญญาประดิษฐ์โดยเฉพาะ เช่น OpenAI Google Azure และ Anthropic บริษัทใหญ่ ๆ ที่สามารถลงทุนเช่าหรือซื้อเครื่องคอมพิวเตอร์ที่มีสมรรถนะสูงเหล่านี้เท่านั้นที่สามารถใช้งานโมเดลภาษาขนาดใหญ่ได้โดยไม่ต้องพึ่งพาบริษัทที่ให้บริการด้านปัญญาประดิษฐ์

```{margin} คำศัพท์
พารามิเตอร์ (parameter) 
```

ขนาดและคุณภาพของข้อมูลในการใช้ฝึกโมเดลภาษาเป็นอีกปัจจัยหนึ่งที่สำคัญ ข้อมูลที่มีคุณภาพสูงและมีปริมาณมากจะทำให้โมเดลภาษาขนาดใหญ่มีความสามารถที่ดีขึ้น โดยทั่วไปแล้วข้อมูลที่ใช้ในการฝึกโมเดลภาษาขนาดใหญ่มักเป็นข้อมูลที่มีคุณภาพสูงที่หาได้จากอินเตอร์เน็ต ข้อมูลส่วนหนึ่งที่ใช้ในการฝึกโมเดลจีพีที-2 และโมเดลจีพีที-3 ยกมาจากคลังข้อมูลที่เรียกว่า Common Crawl ซึ่งเป็นคลังข้อมูลขนาดใหญ่ที่เก็บข้อมูลจากเว็บไซต์ทั่วโลก เพราะฉะนั้นความรู้ที่โมเดลภาษาเรียนรู้มาได้จะจำกัดอยู่ในเนื้อหาที่อยู่ในคลังข้อมูลเหล่านี้เท่านั้น  
เราสามารถแยกประเภทของเว็บไซต์ที่อยู่ในคลังข้อมูลนี้ได้เป็นหลายประเภท ดังตารางต่อไปนี้

| ประเภทของเว็บไซต์            | ตัวอย่าง                        | เนื้อหา                                                       |
|-----------------------------|------------------------------|---------------------------------------------------------------|
| เว็บไซต์ข่าว                  | BBC, CNN, The New York Times, The Guardian | ข่าวสาร บทบรรณาธิการ บทความความคิดเห็น |
| บล็อกและเว็บไซต์ส่วนตัว       | WordPress, Blogger, Medium | เรื่องราวส่วนตัว ความคิดเห็น บทเรียน รีวิว และเนื้อหาส่วนตัวหลากหลาย              |
| เว็บไซต์อีคอมเมิร์ซ           | Amazon, eBay, Shopify  | คำอธิบายสินค้า รีวิวจากผู้ใช้ การให้คะแนน ข้อมูลราคา และรูปภาพสินค้า               |
| เว็บไซต์การศึกษาและวิชาการ    | หน้าเว็บโรงเรียน มหาวิทยาลัย คอร์สออนไลน์ บล็อกการศึกษา | งานวิจัย เอกสารประกอบการเรียน บทความการศึกษา และสิ่งพิมพ์ทางวิชาการ            |
| ฟอรัมและบอร์ดสนทนา           | Reddit, Stack Exchange, Quora | เนื้อหาที่ผู้ใช้สร้างขึ้น คำถามและคำตอบ การสนทนา และการโต้ตอบในชุมชน              |
| โซเชียลมีเดีย                 | X, Tumblr, เพจ Facebook ที่เปิดเป็นสาธารณะ | การโต้ตอบทางสังคม โพสต์สาธารณะ ความคิดเห็น และเนื้อหามัลติมีเดีย                |
| เว็บไซต์รัฐบาลและองค์กรไม่แสวงหากำไร | หน้าเว็บขององค์กรต่าง ๆ | เอกสารนโยบาย รายงาน การประกาศสาธารณะ และเนื้อหาข้อมูล                        |
| เว็บไซต์บริษัทและธุรกิจ        | หน้าเว็บของบริษัท | ข่าวธุรกิจ ข่าวประชาสัมพันธ์ โปรไฟล์บริษัท และข้อมูลสินค้า                      |
| เว็บไซต์เทคนิค       | GitHub และ Stack Overflow | โค้ดรีโพซิทอรี เอกสารทางเทคนิค บทเรียนการเขียนโปรแกรม และการสนทนาของนักพัฒนา    |
| เว็บไซต์สื่อและบันเทิง         | YouTube ในกล่องคำอธิบายวิดีโอ, IMDb, Rotten Tomatoes | รีวิวภาพยนตร์ คำอธิบายรายการทีวี ข่าวดารา และเนื้อหามัลติมีเดีย                |
| ฐานความรู้และสารานุกรม         | Wikipedia, Britannica, HowStuffWorks | บทความสารานุกรม เนื้อหาข้อมูล และทรัพยากรการศึกษา                         |
| เว็บไซต์สุขภาพและสุขภาวะ       | WebMD  | บทความสุขภาพ งานวิจัยทางการแพทย์ เคล็ดลับสุขภาพ และประสบการณ์ผู้ใช้           |
| เว็บไซต์การเงินและเศรษฐกิจ    | Bloomberg, Financial Times | ข่าวการเงิน การวิเคราะห์ตลาด คำแนะนำการลงทุน และรายงานเศรษฐกิจ                |
| เว็บไซต์ท่องเที่ยวและการท่องเที่ยว | TripAdvisor, Lonely Planet | คู่มือท่องเที่ยว รีวิวสถานที่ท่องเที่ยว เคล็ดลับการท่องเที่ยว และเนื้อหาที่ผู้ใช้สร้างขึ้น |

ข้อสังเกตหนึ่งจากแหล่งข้อมูลที่ใช้ในการเทรนโมเดลภาษาคือ แหล่งข้อมูลที่มีข้อมูลเกี่ยวกับประเทศไทยอาจจะมีไม่มากนัก เนื่องจากข้อมูลเกี่ยวกับประเทศไทยมักจะเป็นภาษาไทย และไม่ค่อยถูกจัดเก็บในรูปดิจิทัล อีกทั้งคลังข้อมูลนี้ประกอบด้วยข้อมูลที่เป็นภาษาอังกฤษมากถึง 55% ทำให้พารามิเตอร์จำนวนมากถูกใช้ในการเรียนรู้ภาษาอังกฤษ และความรู้ที่เป็นภาษาอังกฤษ ทำให้ความรู้ภาษาไทย และความรู้เกี่ยวกับประเทศไทยอาจจะไม่ได้รับความสำคัญมากเท่า ส่งผลให้โมเดลภาษาขนาดใหญ่ที่มีความสามารถทัดเทียมจีพีที-3 อาจจะมีความสามารถในการเข้าใจและสร้างข้อความที่เกี่ยวกับประเทศไทยน้อยกว่า และอาจจะมีข้อผิดพลาดทางไวยากรณ์ และความหมายที่มากขึ้นเมื่อผลิตข้อความที่เป็นภาษาไทยที่ออกมา  

## วิธีการเรียกใช้เอพีไอ

ส่วนต่อประสานโปรแกรมประยุกต์ หรือ เอพีไอ (Application Programming Interface หรือ API)  คือชุดของคำสั่งและโปรโตคอลที่อนุญาตให้ซอฟต์แวร์ต่าง ๆ สามารถสื่อสารกันได้อย่างมีประสิทธิภาพ เราสามารถนึกถึงเอพีไอ เป็นตัวกลางที่เชื่อมต่อระบบสองระบบเพื่อให้สามารถแลกเปลี่ยนข้อมูลและคำสั่งระหว่างกันได้ เช่น 

- เอพีไอของ Tiktok เป็นตัวประสานระหว่างแอพพลิเคชันที่ผู้ใช้โหลดไว้บนมือถือ กับฐานข้อมูลคลิปของ Tiktok
- เอพีไอของ Grab เป็นตัวประสานระหว่างแอพพลิเคชัน Grab ของผู้สั่งอาหาร กับแอพพลิเคชัน Grab ของไรเดอร์ แอพพลิเคชัน Grab ของฝั่งร้านอาหาร คำสั่งอาหารของผู้ใช้ต้องถูกส่งผ่านเอพีไอไปยังร้านอาหารเพื่อเตรียมอาหาร และถูกส่งไปยังไรเดอร์เพื่อจัดส่ง และในระหว่างรอเอพีไอจะเป็นตัวประสานให้ผู้ใช้และไรเดอร์สามารถติดต่อกันได้ และเห็นสถานะการจัดส่ง ณ ปัจจุบันได้ 

ในบริบทของการเขียนโปรแกรมเพื่อประมวลผลภาษาธรรมชาติเราจะใช้เอพีไอเพื่อใช้บริการจากโมเดลภาษาขนาดใหญ่ที่อยู่บนเครื่องแม่ข่าย หรือเซิร์ฟเวอร์ (server) ของผู้ให้บริการด้านปัญญาประดิษฐ์ เราเรียกเครื่องของผู้ขอใช้บริการว่าไคลเอนต์ หรือเครื่องลูกข่าย (client)การทำงานของเอพีไอ มีหลายขั้นตอนที่สำคัญ เมื่อไคลเอนต์ (โปรแกรมของเราเอง) เรียกใช้เอพีไอ แอปพลิเคชันจะส่งคำขอ (request) ไปยังเซิร์ฟเวอร์ที่มีเอพีไอนั้น ๆ อยู่ จากนั้นเซิร์ฟเวอร์จะประมวลผลคำขอและส่งคำตอบ (response) กลับมาให้แอปพลิเคชัน การเรียกใช้เอพีไอจะคล้ายคลึงกับการเรียกฟังก์ชันบนเครื่องของเราเอง เราอาจจะเปรียบเทียบ API ได้คล้ายกับฟังก์ชันที่อยู่บนอินเตอร์เน็ต ไม่ได้อยู่บนเครื่องของเราเอง ในการเรียกฟังก์ชันเราต้องระบุฟังก์ชันที่ต้องการเรียกโดยการระบุชื่อ ในการเรียกใช้เอพีไอเราต้องระบุจุดเชื่อมต่อ (endpoint) ซึ่งจะอยู่ในรูปแบบของ URL (Uniform Resource Locator) ซึ่งเป็นวิธีการระบุที่อยู่ของทรัพยากรที่อยู่บนอินเตอร์เน็ต ตัวอย่างเช่น 
`https://api.openai.com/v1/chat/completions` เป็นจุดเชื่อมต่อที่ใช้ในการร้องขอข้อความจากโมเดลภาษาขนาดใหญ่ของ OpenAI ดู ๆ ไปแล้ว URL ดูเหมือนกับจะเป็นที่อยู่เว็บไซต์ แต่ว่าถ้าเราลองเอา URL ของจุดเชื่อมต่อเหล่านี้ไปเปิดดูบนเบราว์เซอร์ เช่น Chrome Safari หรือ Firefox ก็จะไม่หน้าเว็บไซต์อย่างที่ควรจะเป็นเนื่องจาก URL ชี้ไปที่จุดเชื่อมต่อของเอพีไอ ไม่ได้ชี้ไปหน้าเว็บไซต์ใด ๆ 
เพราะฉะนั้นหากเราจะใช้บริการเอพีไอใด เราจะต้องไปหามาว่าจุดเชื่อมต่อของบริการที่ต้องการใช้นั้นอยู่ที่ URL ใด 

ประการต่อมา การเรียกฟังก์ชันจะต้องมีการระบุพารามิเตอร์เพื่อใช้เป็น input หรือปรับวิธีการทำงานของฟังก์ชันนั้นให้เหมาะกับการใช้งานของเรา การเรียกใช้เอพีไอก็เช่นเดียวกัน ตัวอย่างเช่น การเรียกใช้เอพีไอของ OpenAI ในการผลิตข้อความจากโมเดลภาษาขนาดใหญ่ เราต้องระบุข้อความที่ต้องการให้โมเดลภาษาขนาดใหญ่ประมวลผล และระบุโมเดลรุ่นที่ต้องการใช้ ซึ่งเป็นพารามิเตอร์ที่จะต้องระบุ นอกจากนั้นเรายังปรับพารามิเตอร์อ่ื่น ๆ ได้อีก เช่น ต้องการให้ข้อความที่ได้กลับมายาวเท่าไร และทั้งหมดกี่ข้อความ ซึ่งเป็นพารามิเตอร์ที่ไม่ได้บังคับต้องระบุ คู่มือการใช้เอพีไอจะบอกโดยละเอียดว่ามีพารามิเตอร์อะไรบ้าง อะไรจำเป็นต้องใส่ อะไรไม่จำเป็นต้องใส่

เนื่องจากว่าเอพีไอเป็นสิ่งที่อยู่บนอินเตอร์เน็ต จึงต้องมีการควบคุมว่าใครมีสิทธิ์เข้าใช้บ้าง สามารถใช้ได้มากน้อยแค่ไหน หรืออาจจะมีจุดประสงค์เพื่อเก็บค่าใช้บริการตามปริมาณการใช้งาน ระบบการตรวจสอบสิทธิ์ (authentication) ที่ใช้สำหรับเอพีไอมีอยู่หลากหลายวิธี แต่วิธีที่นิยมกันวิธีหนึ่งคือ การใช้กุญแจเอพีไอ (API Key) ซึ่งเป็นรหัสยาว ๆ ที่ผู้ให้บริการเอพีไอจะออกให้ เมื่อผู้ใช้ได้ลงทะเบียนบนหน้าเว็บเพื่อเปิดบัญชี และขอกุญแจเอพีไอที่ผูกกับบัญชีของเรา จากนั้นจึงนำกุญแจเอพีไอนี้ไปใช้ในการเรียกใช้เอพีไอ โดยเอพีไอจะตรวจสอบว่ากุญแจเอพีไอที่ส่งมานั้นถูกต้องหรือไม่ ถ้าถูกต้องเอพีไอจะอนุญาตให้เราเข้าใช้บริการตามที่เราร้องขอได้ แต่ถ้าไม่ถูกต้องเอพีไอจะปฏิเสธการเข้าใช้บริการ

| ส่วนประกอบ | ฟังก์ชัน | เอพีไอ |
|-----------|--------|-------|
| การระบุสิ่งที่ต้องการเรียกใช้        | ชื่อฟังก์ชัน | จุดเชื่อมต่อ |
| การระบุ input หรือปรับรายละเอียดการใช้งาน       | พารามิเตอร์ | พารามิเตอร์ |
| การตรวจสอบสิทธิ์ในการใช้งาน | ไม่มี | กุญแจเอพีไอ |

การเรียกใช้เอพีไอสามารถทำด้วยภาษาไพธอนได้ด้วยไลบรารี `requests` โดยระบุกุญแจเอพีไอในส่วนหัว (header) ของคำขอ และระบุค่าพารามิเตอร์ในรูปของดิกชันนารีที่คีย์เป็นชื่อพารามิเตอร์ และแวลูเป็นค่าของพารามิเตอร์นั้น ๆ ดังตัวอย่างต่อไปนี้

```python
import requests
response = requests.post(
    endpoint='https://api.openai.com/v1/chat/completions',
    headers = {'Authorization': 'Bearer 1234567890รหัสกุญแจเอพีไอ'},
    data = {
        'model': 'gpt-4o',
        'messages': [
            {"role": "system", "content": "You are a helpful assistant."},
            {"role": "user", "content": "Hello!"}
        ],
        'temperature': 0.6
    }
)
```

ในตัวอย่างนี้เราใช้เอพีไอที่อยู่ที่จุดเชื่อมต่อ (`endpoint`) `https://api.openai.com/v1/chat/completions` และใส่กุญแจเอพีไอเอาไว้ในส่วนหัว (`headers`) ของคำขอ และระบุพารามิเตอร์ทั้งหมด 3 ตัวได้แก่ `model`, `messages`, และ `temperature` โดย `model` คือ โมเดลที่ต้องการใช้ ซึ่งในตัวอย่างนี้เราใช้โมเดล `gpt4-o` `messages` คือ ข้อความในบทสนทนาที่ต้องการให้โมเดลตอบ  และ `temperature` คือ ค่าที่บอกถึงความเสี่ยงที่เรายอมรับในการให้โมเดลตอบ ค่าที่เราใส่คือ 0.6 ทั้งนี้ผู้ใช้จะต้องอ้างอิงคู่มือการใช้เอพีไอด้วยตนเองว่าต้องตรวจสอบสิทธิ์การเข้าใช้อย่างไร และระบุพารามิเตอร์อะไรบ้าง 

ผลลัพธ์ที่ได้จากการเรียกใช้เอพีไอจะเป็นอ็อบเจกต์ที่เก็บข้อมูลที่เอพีไอส่งกลับมาให้เรา ซึ่งเราสามารถใช้ข้อมูลนี้ในการประมวลผลต่อไปได้ โดยเราสามารถเข้าถึงข้อมูลที่เอพีไอส่งกลับมาได้ด้วยการอ้างอิงถึงข้อมูลที่เก็บในอ็อบเจกต์นี้ ด้วยเมท็อด `response.json()` ดังตัวอย่างต่อไปนี้

```python
{
  "id": "chatcmpl-123",
  "object": "chat.completion",
  "created": 1677652288,
  "model": "gpt-4o",
  "system_fingerprint": "fp_44709d6fcb",
  "choices": [{
    "index": 0,
    "message": {
      "role": "assistant",
      "content": "\n\nHello there, how may I assist you today?",
    },
    "logprobs": null,
    "finish_reason": "stop"
  }],
  "usage": {
    "prompt_tokens": 9,
    "completion_tokens": 12,
    "total_tokens": 21
  }
}
```

การเรียกเอพีไอหนึ่งครั้งมักจะใช้เวลานานกว่าการเรียกฟังก์ชันหนึ่งครั้ง เพราะว่าจะต้องใช้เวลาในการสื่อสารผ่านเครือข่ายอินเตอร์เน็ต ซึ่งช้ากว่าการคำนวณประมวลผลจากเครื่องคอมพิวเตอร์เครื่องเดียวกันกับที่เรียกใช้ฟังก์ชัน เอพีไอจึงมักจะคืนค่ามาหลายค่าเผื่อในกรณีที่ผู้ใช้งานต้องการค่าอื่น ๆ ด้วย ทำให้ผู้ใช้งานไม่ต้องเรียกเอพีไอหลายครั้ง ในตัวอย่างข้างต้น คำตอบจากเอพีไอมีถึง 7 ค่าซึ่งเท่ากับจำนวนคีย์ของดิกชันนารี  คำตอบที่เราได้รับจากเอพีไอมักจะอยู่ในรูปดิกชันนารีที่มีคีย์เป็นชื่อค่าผลลัพธ์ เช่น `model` `choices` และ `usage` และแวลูเป็นค่าของคีย์นั้น ๆ เช่น `gpt-4o` ในตัวอย่างนี้ 


## วิธีการเรียกใช้โมเดลภาษาขนาดใหญ่ผ่านไคลเอนต์ของ OpenAI

การเรียกใช้เอพีไอโดยสร้างคำขอและประมวลผลคำตอบจากเอพีไอด้วยตนเองมีวิธีการใช้ที่ค่อนข้างยุ่งยาก และมีโอกาสผิดพลาดสูง ภาระตกอยู่กับผู้ใช้งานเอพีไอที่จะต้องศึกษาคู่มือการใช้อย่างละเอียด เพื่อที่จะใส่พารามิเตอร์ได้ถูกต้อง และดึงผลลัพธ์จากคำตอบจากเอพีไอที่ต้องการได้ ดังนั้นผู้ให้บริการหลายบริษัทจึงมักจะให้ไลบรารีภาษาต่าง ๆ ที่ช่วยให้เราใช้เอพีไอได้ง่ายขึ้น ไลบรารีที่ช่วยอำนวยความสะดวกในการจัดโครงสร้างคำขอเพื่อส่งให้เอพีไอเรียกว่าไคลเอนต์ (client)  ไคลเอนต์จะมีฟังก์ชันที่เราสามารถเรียกใช้ได้เหมือนกับการเรียกฟังก์ชันบนเครื่องของเราเอง แต่เบื้องหลังไคลเอนต์จะเป็นตัวทำงานในการเปลี่ยนการเรียกฟังก์ชัน เป็นการสร้างคำขอ ส่งคำขอไปยังจุดเชื่อมต่อเอพีไอที่ถูกต้อง รอรับคำตอบจากเซิร์ฟเวอร์ และแปลงให้อยู่ในรูปอ็อบเจกต์ที่ใช้งานง่ายขึ้น ก่อนคืนค่ากลับมาให้ผู้ใช้ เราเรียกว่าไคลเอนต์ว่าตัวห่อ (wrapper) ที่ห่อการใช้เอพีไอไว่้อีกชั้นหนึ่ง 

ในที่นี้เราจะใช้ไคลเอนต์ของ OpenAI ที่ชื่อว่า `openai` ซึ่งเป็นไลบรารีที่ช่วยให้ใช้งานบริการของ OpenAI  โดยไม่ต้องเขียนโค้ดเองเพื่อสร้างคำขอ และส่งคำขอไปยังเซิร์ฟเวอร์ของ OpenAI เพื่อป้องกันข้อผิดพลาดในการเรียกใช้งาน ขั้นตอนแรกในการใช้คือต้องเปิดบัญชีที่ `https://platform.openai.com/signup` และขอกุญแจเอพีไอ จากนั้นเราสามารถใช้ไคลเอนต์ของ OpenAI ได้ดังนี้

```python
import openai
openai.api_key = "รหัสกุญแจเอพีไอที่ได้จากการลงทะเบียน"
response = openai.chat.completions.create(
    model="gpt-4o-2024-05-13",
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Who founded Chulalongkorn University?"}
    ],
)
```
การเรียกใช้ไคลเอนต์นอกเหนือจากการระบุกุญแจเอพีไอโดยการตั้งค่า `openai.api_key` แล้วยังจะต้องระบุ input อย่างน้อยสองอย่าง 

- `model` ชื่อโมเดลที่ต้องการใช้ เราสามารถตรวจสอบจากคู่มือการใช้เอพีไอได้ว่ามีโมเดลประเภทใดให้เราได้เลือกใช้ได้บ้าง เช่น `gpt-4o` `gpt-4o-mini` `gpt-4` `gpt-3.5-turbo` ในตัวอย่างเราเลือกใช้ `gpt-4o-2024-05-13` ซึ่งหมายถึงโมเดล GPT-4O เวอร์ชันของวันที่ 13 พฤษภาคม 2024 หากเราไม่ระบุเวอร์ชั่น ระบุแต่ชื่อโมเดลอย่างเดียว เอพีไอจะนำเวอร์ชันล่าสุดมาใช้ เช่น ถ้าระบุว่าเป็น `gpt-4o` จะใช้เวอร์ชันล่าสุดของ GPT-4O
- `messages` คือ ลิสต์ของข้อความที่จะใช้เป็นบริบทในการตอบ ข้อความอยู่ในรูปของดิกชันนารีที่มีคีย์ `content` ไว้ใส่ข้อความที่จะให้โมเดลภาษาขนาดใหญ่นำไปประมวลผล นอกจากนั้น `role` เพื่อระบุว่าใครเป็นเจ้าของข้อความ มีค่าที่เป็นไปได้ทั้งหมด 3 ค่า ได้แก่่ 
    - `system` เพื่อระบุว่าข้อความเป็นพรอมต์ในระดับระบบ หรือพรอมต์ที่บอกวิธีการตอบสนองต่อพรอมต์ของโมเดล ในตัวอย่างข้างต้นเราระบุแบบง่าย ๆ ว่า `"You are a helpful assistant"` เราจะมาศึกษาวิธีการเขียนพรอมต์ในระดับระบบในหัวข้อถัดไป 
    - `user` เพื่อระบุว่าข้อความเป็นพรอมต์จากผู้ใช้ ในตัวอย่างข้างต้นเราระบุเป็นคำถามว่าใครเป็นผู้ก่อตั้งจุฬาลงกรณ์มหาวิทยาลัย
    - `assistant` เพื่อระบุตว่าข้อความเป็นคำตอบที่ได้กลับมาจากโมเดล เพื่อนำไปใช้เป็นบริบทในการตอบคำถามต่อ ๆ ไปได้ 

คำตอบที่ได้มาจากเอพีไอมีโครงสร้างเป็นดิกชันนารีดังนี้

```python
{'id': 'chatcmpl-9m0hnPhnRpMHrL1DyDCON3vWHmk7q',
 'choices': [{'finish_reason': 'stop',
   'index': 0,
   'logprobs': None,
   'message': {'content': "Chulalongkorn University, located in Bangkok, Thailand, was founded by King Vajiravudh, also known as King Rama VI. The university is named in honor of his father, King Chulalongkorn (Rama V). It was officially established in 1917 and is considered Thailand's oldest institution of higher education. The foundation of the university was part of King Vajiravudh’s efforts to modernize and improve education in Thailand.",
    'role': 'assistant',
    'function_call': None,
    'tool_calls': None}}],
 'created': 1721229483,
 'model': 'gpt-4o-2024-05-13',
 'object': 'chat.completion',
 'service_tier': None,
 'system_fingerprint': 'fp_c4e5b6fa31',
 'usage': {'completion_tokens': 93, 'prompt_tokens': 26, 'total_tokens': 119}}
 ```

ไคลเอนต์ได้แปลงดิกชันนารีข้างต้นมาเป็นอ็อบเจกต์ที่ค่าประจำตัว (attribute) เป็นชื่อเดียวกับคีย์ของดิกชันนารี เพราะฉะนั้นหาเราต้องการข้อความที่ตัวโมเดลภาษาขนาดใหญ่ตอบมา เราสามารถเข้าถึงได้ด้วยการอ้างอิงถึงคีย์ของดิกชันนารี ดังตัวอย่างต่อไปนี้

```python
response.choices[0].message.content
```

ซึ่งจะคืนค่า

```python
"Chulalongkorn University, located in Bangkok, Thailand, was founded by King Vajiravudh, also known as King Rama VI. The university is named in honor of his father, King Chulalongkorn (Rama V). It was officially established in 1917 and is considered Thailand's oldest institution of higher education. The foundation of the university was part of King Vajiravudh’s efforts to modernize and improve education in Thailand."
```

โมเดลภาษาขนาดใหญ่จำพวก ChatGPT มีความสามารถในการตอบสนองต่อพรอมต์แบบอิงบริบทของบทสนทนาได้ กล่าวคือระบบสามารถทำความเข้าใจได้ว่าได้พูดถึงอะไรมาบ้างแล้ว ตัวอย่างเช่น เราสามารถถามต่อเนื่องไปได้ว่า "How big is it?" 

```python
new_messages = messages_so_far + 
    [response.choices[0].message, {"role": "user", "content": "How big is it?"}]
```

ซึ่งจะทำให้เราได้ลิสต์ที่มีข้อความทั้งหมดดังนี้

```python
[
    {'role': 'system', 'content': 'You are a helpful assistant.'},
    {'role': 'user', 'content': 'Who founded Chulalongkorn University?'},
    ChatCompletionMessage(content='Chulalongkorn University, the oldest university in Thailand, was founded by King Vajiravudh (Rama VI) in 1917. The university was named after his father, King Chulalongkorn (Rama V), who had initiated the idea of creating a modern education system in Thailand. King Chulalongkorn had established several institutions that laid the groundwork for the university, but it was his son, King Vajiravudh, who officially established the university as a higher education institution.', role='assistant', function_call=None, tool_calls=None),
    {'role': 'user', 'content': 'How big is it?'}]
 ```

สังเกตว่าข้อความที่สามอยู่ในรูปของอ็อบเจกต์ `ChatCompletionMessage` ซึ่งเป็นตัวห่อดิกชันนารีที่มีคีย์ `role` และ `content` เอาไว้ สังเกตอีกว่าค่าของ `role` เป็น `assistant` เพื่อระบุว่าเป็นข้อความที่่ผลิตมาจากตัวโมเดลเอง ข้อความถัดจากนั้นซึ่งเป็นข้อความสุดท้าย เป็นข้อความที่มาจากเราซึ่งเป็นผู้ใช้ เมื่อวางโครงสร้างของลิสต์ของข้อความเสร็จเรียบร้อยแล้ว เราจะสามารถส่งไปให้โมเดลตอบผ่านเอพีไอได้ ดังนี้ 

```python
response = openai.chat.completions.create(
    model="gpt-4o",
    messages=new_messages,
)
```
จากนั้นสามารถดึงคำตอบออกมาดูได้ด้วยคำสั่งเดิม `print(response.choices[0].content)`

```
Chulalongkorn University is located in Bangkok, Thailand, and covers a substantial area. The main campus spans approximately 456 acres (about 1.85 square kilometers) in the heart of the city's Pathum Wan District. The campus is known for its well-maintained grounds, historic buildings, and modern facilities. 

Additionally, the university has fields in nearby areas that are used for agricultural studies and research, further contributing to its total land area. The main campus's central location and extensive grounds make it a prominent and significant educational landmark in Bangkok.
```

โมเดลตอบคำถามได้ถูกต้อง ถึงแม้ว่าในพรอมต์ล่าสุดเราจะถามเพียงว่า *How big is it?* โมเดลรู้บริบทของบทสนทนาผ่าน `new_messages` จึงสามารถเข้าใจได้่ว่า *it* ที่เป็นสรรพนามนั้น เป็นสรรพนามที่อ้างถึงจุฬาลงกรณ์มหาวิทยาลัย แสดงให้เห็นยว่าโมเดลมีการประมวลผลบริบทของบทสนทนาได้อย่างถูกต้อง 

กรณีการใช้งานโมเดลภาษาขนาดใหญ่ที่คนมักนึกถึง คือการตอบคำถามต่าง ๆ และอาจจะมีการโต้ตอบกันไปมา เพื่อถามคำถามที่ลึกขึ้น ที่จริงแล้วโมเดลภาษาขนาดใหญ่สามารถถูกปรับใช้ในงานอื่น ๆ ได้ด้วย ซึ่งเราจะมาดูตัวอย่างการใช้งานโมเดลภาษาขนาดใหญ่ในงานอื่น ๆ ในหัวข้อถัดไป

## การเขียนพรอมต์ 

### การรับบทบาท

### การกำหนดงานให้ชัดเจน

### การเพ่ิมเติมข้อมูลทางบริบทที่เฉพาะเจาะจง

### การจัดรูปแบบของผลลัพธ์

### Prefix completion

### Few-shot learning

### Chain-of-thought

### การแปลงให้เป็น agent 

## การใช้งานโมเดลภาษาขนาดใหญ่เพื่อการประมวลผลภาษาธรรมชาติ

### การวิเคราะห์อารมณ์ความรู้สึก

### การสรุปความ

### การแก้ไขข้อผิดพลาดทางไวยากรณ์

### การถอดความ

### การแปลภาษา

## กรณีศึกษาการทำแอพพลิเคชันด้วยโมเดลภาษาขนาดใหญ่

### การสร้างคอนเทนต์สำหรับสื่อสังคมออนไลน์

### การวิเคราะห์อารมณ์ความรู้สึกจากรีวิวสินค้าออนไลน์

### การสร้างแชทบอท

## สรุป


